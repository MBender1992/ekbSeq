% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apply_contrasts.R
\name{apply_contrasts}
\alias{apply_contrasts}
\title{Extract and Annotate DESeq2 Contrast Results with Optional LFC Shrinkage}
\usage{
apply_contrasts(
  dds,
  trt,
  ctrl,
  lfcThres = 0,
  pThres = 0.05,
  condition = "condition",
  annObj = NULL,
  shrink = FALSE,
  path = NULL
)
}
\arguments{
\item{dds}{DESeq object.}

\item{trt}{Character. The treatment group label to be contrasted.}

\item{ctrl}{Character. The control group label to serve as the baseline.}

\item{lfcThres}{log2FoldChange thresholds used in the results function.}

\item{pThres}{P-value threshold used in the results function.}

\item{condition}{Character. The factor name in \code{dds} defining the experimental condition.
Default is \code{"condition"}.}

\item{annObj}{A data frame containing annotation information for the genes. Must have the same
number of rows as the result object. If provided, the annotation is merged with the DE results.
Default is \code{NULL}.}

\item{shrink}{Logical. If \code{TRUE}, log2 fold change shrinkage is performed using \code{lfcShrink}.
Default is \code{FALSE}.}

\item{path}{Character. The directory path where the Excel file (of shrunken and annotated results)
will be saved. This argument is used only when \code{shrink = TRUE}.}
}
\value{
A data frame containing the differential expression results for the specified contrast.
If an annotation object is provided, the results include the merged annotation columns. When
\code{shrink = TRUE} and an annotation object is provided, the annotated results are also saved
as an Excel file in the specified path.
}
\description{
This function extracts differential expression results for a specified contrast from a global
DESeq2 results object (\code{dds}). It constructs the contrast using a helper function
(\code{contraster}), and optionally applies log2 fold change shrinkage via \code{lfcShrink} (using
the "ashr" method). If an annotation object is provided, the function merges the annotation with
the results and removes any Ensembl IDs containing a period. Additionally, when shrinkage is enabled,
the annotated results are saved as an Excel file (.xlsx) to the specified path.
}
\details{
The function uses a global DESeq2 object \code{dds} along with preset thresholds \code{lfcThres}
and \code{pThres}. It builds the contrast with \code{contraster(dds, group1 = list(c(condition, trt)),
group2 = list(c(condition, ctrl)))}. When \code{shrink = TRUE}, the function applies the \code{lfcShrink}
function using the "ashr" method to obtain shrunken fold changes. If an annotation data frame
(\code{annObj}) is supplied, the function checks that its dimensions match the results, merges the
annotation via \code{left_join}, and removes rows with Ensembl IDs that contain a period. Finally,
if shrinkage is applied, the annotated results are saved as an Excel file (using \code{write.xlsx})
with a filename constructed from the treatment and control labels.
}
\note{
The variables \code{dds}, \code{lfcThres}, \code{pThres}, and the helper function \code{contraster}
must be defined in the global environment prior to using this function.
}
\examples{
\dontrun{
# Example usage:
# Assuming dds, lfcThres, pThres, and contraster are properly defined in the global environment,
# and annotation_df is a data frame with gene annotations:
res <- apply_contrasts(trt = "UVB", ctrl = "control", condition = "treatment",
                       annObj = annotation_df, shrink = TRUE, path = "results/")
}

}
